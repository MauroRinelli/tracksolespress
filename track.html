<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solespress – Tracking Spedizioni</title>
  <link rel="stylesheet" href="./css/style.css?v=11">
  <style>
    .modal {
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background-color: #1a1a1a;
      padding: 30px;
      border: 2px solid #FFD700;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      position: relative;
    }
    .modal-content h3 {
      color: #FFD700;
      margin-top: 0;
    }
    .close-modal {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 28px;
      font-weight: bold;
      color: #FFD700;
      cursor: pointer;
    }
    .close-modal:hover {
      color: #fff;
    }
    #messaggio-text {
      background-color: #2a2a2a;
      color: #fff;
      border: 1px solid #FFD700;
      border-radius: 4px;
      resize: vertical;
    }

    .shipping-table-section {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .shipping-table input[type="text"] {
      min-height: 44px;
      font-size: 16px;
    }

    .shipping-table button {
      min-height: 44px;
      min-width: 60px;
      padding: 8px 12px;
      font-size: 14px;
      white-space: nowrap;
    }

    .mobile-home-link img {
      display: block;
      width: auto;
      height: 100%;
      max-height: 40px;
    }

    .mobile-home-link {
      padding: 8px 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media screen and (max-width: 1024px) {
      .shipping-table {
        font-size: 14px;
      }

      .shipping-table th,
      .shipping-table td {
        padding: 8px;
      }

      .shipping-table input[type="text"] {
        width: 100%;
        min-width: 120px;
      }

      .modal-content {
        padding: 20px;
        width: 95%;
      }
    }

    @media screen and (max-width: 767px) {
      .shipping-table-section h2 {
        font-size: 1.2rem;
        margin-bottom: 10px;
      }

      .shipping-table {
        font-size: 12px;
        display: block;
        width: 100%;
      }

      .shipping-table thead,
      .shipping-table tbody,
      .shipping-table th,
      .shipping-table td,
      .shipping-table tr {
        display: block;
      }

      .shipping-table thead {
        display: none;
      }

      .shipping-table tr {
        margin-bottom: 15px;
        border: 1px solid #FFD700;
        border-radius: 8px;
        padding: 10px;
        background-color: rgba(26, 26, 26, 0.5);
      }

      .shipping-table td {
        display: flex;
        flex-direction: column;
        padding: 8px 0;
        border: none;
        text-align: left;
      }

      .shipping-table td:before {
        content: attr(data-label);
        font-weight: bold;
        color: #FFD700;
        margin-bottom: 5px;
        font-size: 11px;
        text-transform: uppercase;
      }

      .shipping-table td:nth-child(4),
      .shipping-table td:nth-child(5),
      .shipping-table td:nth-child(6),
      .shipping-table td:nth-child(7) {
        display: inline-block;
        width: 24%;
        padding: 5px;
      }

      .shipping-table td:nth-child(4):before,
      .shipping-table td:nth-child(5):before,
      .shipping-table td:nth-child(6):before,
      .shipping-table td:nth-child(7):before {
        display: none;
      }

      .shipping-table button {
        width: 100%;
        font-size: 12px;
        padding: 10px 5px;
      }

      .shipping-table input[type="text"] {
        width: 100%;
        min-width: 100%;
        font-size: 16px;
      }

      .modal-content {
        padding: 15px;
        width: 95%;
        max-width: 95%;
      }

      .modal-content h3 {
        font-size: 1.2rem;
      }

      #messaggio-text {
        font-size: 14px;
      }

      .add-row-btn {
        width: 100%;
        padding: 12px;
        font-size: 14px;
      }
    }

    @media screen and (max-width: 480px) {
      .shipping-table-section {
        padding: 10px;
      }

      .modal-content {
        padding: 10px;
      }

      .close-modal {
        right: 10px;
        top: 5px;
        font-size: 24px;
      }

      #messaggio-text {
        font-size: 13px;
        padding: 8px;
      }
    }

    @media screen and (max-width: 767px) and (orientation: landscape) {
      .shipping-table thead {
        display: table-header-group;
      }

      .shipping-table tr {
        display: table-row;
        border: none;
        padding: 0;
      }

      .shipping-table td {
        display: table-cell;
        padding: 8px;
      }

      .shipping-table td:before {
        display: none;
      }
    }
  </style>
</head>
<body>

  <aside class="sb" id="sidebar">
    <div class="sb-header">
      <img src="./media/FHP_Group_Logo_RGB.png" alt="FHP Group" class="logo" />
      <a href="index.html" class="brand">Solespress</a>
    </div>

    <nav class="sb-nav">
      <a href="track.html" class="sb-btn active">
        <img src="./media/corrire.png" alt="Track" class="btn-icon-img" />
        <span class="btn-text">Track</span>
      </a>
    </nav>

    <div class="sb-footer">
      <small>v1.0 • Solespress</small>
    </div>
  </aside>

  <div class="overlay" id="overlay"></div>

  <main class="main track-page">
    <section id="griglia-spedizioni" class="shipping-table-section">
      <h2>Tabella Spedizioni</h2>
      <table class="shipping-table">
        <thead>
          <tr>
            <th>Mittente</th>
            <th>Destinatario</th>
            <th>N° Tracking / Link</th>
            <th>Apri</th>
            <th>Copia</th>
            <th>Invia</th>
            <th>Elimina</th>
          </tr>
        </thead>
        <tbody id="tabella-body">
          <tr>
            <td data-label="Mittente"><input type="text" placeholder="Nome mittente"></td>
            <td data-label="Destinatario"><input type="text" placeholder="Nome destinatario"></td>
            <td data-label="N° Tracking"><input type="text" placeholder="N° tracking o URL"></td>
            <td data-label="Apri"><button class="apri-link">Vai</button></td>
            <td data-label="Copia"><button class="copia-link">Copia</button></td>
            <td data-label="Invia"><button class="invia-messaggio">Invia</button></td>
            <td data-label="Elimina"><button class="elimina-riga">Elimina</button></td>
          </tr>
        </tbody>
      </table>
      <button id="aggiungi-riga" class="add-row-btn">+ Aggiungi riga</button>
    </section>

    <div id="messaggio-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Messaggio Tracking</h3>
        <textarea id="messaggio-text" readonly rows="8" style="width: 100%; padding: 10px; font-family: inherit; margin-bottom: 10px;"></textarea>
        <button id="copia-messaggio" class="add-row-btn">Copia Messaggio</button>
      </div>
    </div>
    <a href="#" id="mobileSidebarToggle" class="mobile-home-link">
      <img src="./media/solespress7272push.png" alt="Solespress" />
    </a>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('aggiungi-riga');
      const body = document.getElementById('tabella-body');

      if (btn) {
        btn.addEventListener('click', () => {
          const righe = body.querySelectorAll('tr');
          if (righe.length >= 10) {
            alert('Hai raggiunto il massimo di 10 righe');
            return;
          }

          if (righe.length > 0) {
            const ultimaRiga = righe[righe.length - 1];
            const inputs = ultimaRiga.querySelectorAll('input[type="text"]');
            const mittente = inputs[0] ? inputs[0].value.trim() : '';
            const destinatario = inputs[1] ? inputs[1].value.trim() : '';
            const tracking = inputs[2] ? inputs[2].value.trim() : '';

            if (!mittente || !destinatario || !tracking) {
              alert('Compila tutti i campi della riga precedente prima di aggiungerne una nuova');
              return;
            }
          }

          const nuovaRiga = document.createElement('tr');
          nuovaRiga.innerHTML = \`
            <td data-label="Mittente"><input type="text" placeholder="Nome mittente"></td>
            <td data-label="Destinatario"><input type="text" placeholder="Nome destinatario"></td>
            <td data-label="N° Tracking"><input type="text" placeholder="N° tracking o URL"></td>
            <td data-label="Apri"><button class="apri-link">Vai</button></td>
            <td data-label="Copia"><button class="copia-link">Copia</button></td>
            <td data-label="Invia"><button class="invia-messaggio">Invia</button></td>
            <td data-label="Elimina"><button class="elimina-riga">Elimina</button></td>
          \`;
          body.appendChild(nuovaRiga);
        });
      }

      function buildTrackingUrl(input) {
        if (!input) return null;
        input = input.trim();

        if (input.match(/^https?:\/\//i)) {
          return input;
        }

        if (/^1Z[A-Z0-9]+$/i.test(input)) {
          return \`https://www.ups.com/track?track=yes&trackNums=\${input}&loc=it_IT&requester=ST/trackdetails\`;
        }

        if (/^\d{10,11}$/.test(input)) {
          return \`https://www.dhl.com/it-en/home/tracking.html?tracking-id=\${input}&submit=1\`;
        }

        if (/^\d{13}$/.test(input)) {
          return \`https://www.poste.it/cerca/index.html#/risultati-spedizioni/\${input}\`;
        }

        if (/^\d{12}$/.test(input) || /^\d{14,}$/.test(input)) {
          return \`https://www.fedex.com/fedextrack/duplicate-results/select?duplicateTrackingId=\${input}&trknbr=\${input}\`;
        }

        if (input.includes('.') && !input.includes(' ')) {
          return \`https://\${input}\`;
        }

        if (/^\d+$/.test(input)) {
          return \`https://www.fedex.com/fedextrack/?trknbr=\${encodeURIComponent(input)}\`;
        }

        return null;
      }

      document.addEventListener('click', e => {
        if (e.target.classList.contains('apri-link')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const trackingInput = inputs[2];
          const input = trackingInput ? trackingInput.value : '';
          const trackingUrl = buildTrackingUrl(input);

          if (trackingUrl) {
            window.open(trackingUrl, '_blank');
          } else {
            alert('Inserisci un numero di tracking o un link valido');
          }
        }

        if (e.target.classList.contains('copia-link')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const trackingInput = inputs[2];
          const input = trackingInput ? trackingInput.value : '';
          const trackingUrl = buildTrackingUrl(input);

          if (trackingUrl) {
            navigator.clipboard.writeText(trackingUrl).then(() => {
              const btn = e.target;
              const originalText = btn.textContent;
              btn.textContent = '✓ Copiato!';
              btn.style.backgroundColor = '#28a745';

              setTimeout(() => {
                btn.textContent = originalText;
                btn.style.backgroundColor = '';
              }, 2000);
            }).catch(err => {
              alert('Errore durante la copia: ' + err);
            });
          } else {
            alert('Inserisci un numero di tracking o un link valido');
          }
        }

        if (e.target.classList.contains('invia-messaggio')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const mittente = inputs[0] ? inputs[0].value.trim() : '';
          const destinatario = inputs[1] ? inputs[1].value.trim() : '';
          const trackingInput = inputs[2] ? inputs[2].value.trim() : '';

          if (!mittente || !destinatario || !trackingInput) {
            alert('Compila tutti i campi (Mittente, Destinatario e N° Tracking)');
            return;
          }

          const trackingUrl = buildTrackingUrl(trackingInput);
          if (!trackingUrl) {
            alert('Numero di tracking non valido');
            return;
          }

          const messaggio = \`Gentile \${destinatario},

La spedizione da parte di \${mittente} è stata inviata.

Codice di monitoraggio: \${trackingInput}

Puoi tracciare la tua spedizione al seguente link:
\${trackingUrl}

Cordiali saluti,
\${mittente}\`;

          const modal = document.getElementById('messaggio-modal');
          const textarea = document.getElementById('messaggio-text');
          textarea.value = messaggio;
          modal.style.display = 'flex';
        }

        if (e.target.classList.contains('elimina-riga')) {
          const righe = body.querySelectorAll('tr');

          if (righe.length <= 1) {
            alert('Devi mantenere almeno una riga nella tabella');
            return;
          }

          const row = e.target.closest('tr');
          row.remove();
        }
      });

      const modal = document.getElementById('messaggio-modal');
      const closeBtn = document.querySelector('.close-modal');

      closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
      });

      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
        }
      });

      document.getElementById('copia-messaggio').addEventListener('click', () => {
        const textarea = document.getElementById('messaggio-text');
        textarea.select();
        navigator.clipboard.writeText(textarea.value).then(() => {
          const btn = document.getElementById('copia-messaggio');
          const originalText = btn.textContent;
          btn.textContent = '✓ Messaggio Copiato!';
          btn.style.backgroundColor = '#28a745';

          setTimeout(() => {
            btn.textContent = originalText;
            btn.style.backgroundColor = '';
          }, 2000);
        }).catch(err => {
          alert('Errore durante la copia: ' + err);
        });
      });

      const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');

      if (mobileSidebarToggle) {
        mobileSidebarToggle.addEventListener('click', (e) => {
          e.preventDefault();
          document.body.classList.add('sidebar-open');
        });
      }

      if (overlay) {
        overlay.addEventListener('click', () => {
          document.body.classList.remove('sidebar-open');
        });
      }
    });
  </script>
</body>
</html>
ENDOFFILEcat > track.html << 'ENDOFFILE'
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solespress – Tracking Spedizioni</title>
  <link rel="stylesheet" href="./css/style.css?v=11">
  <style>
    .modal {
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background-color: #1a1a1a;
      padding: 30px;
      border: 2px solid #FFD700;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      position: relative;
    }
    .modal-content h3 {
      color: #FFD700;
      margin-top: 0;
    }
    .close-modal {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 28px;
      font-weight: bold;
      color: #FFD700;
      cursor: pointer;
    }
    .close-modal:hover {
      color: #fff;
    }
    #messaggio-text {
      background-color: #2a2a2a;
      color: #fff;
      border: 1px solid #FFD700;
      border-radius: 4px;
      resize: vertical;
    }

    .shipping-table-section {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .shipping-table input[type="text"] {
      min-height: 44px;
      font-size: 16px;
    }

    .shipping-table button {
      min-height: 44px;
      min-width: 60px;
      padding: 8px 12px;
      font-size: 14px;
      white-space: nowrap;
    }

    .mobile-home-link img {
      display: block;
      width: auto;
      height: 100%;
      max-height: 40px;
    }

    .mobile-home-link {
      padding: 8px 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media screen and (max-width: 1024px) {
      .shipping-table {
        font-size: 14px;
      }

      .shipping-table th,
      .shipping-table td {
        padding: 8px;
      }

      .shipping-table input[type="text"] {
        width: 100%;
        min-width: 120px;
      }

      .modal-content {
        padding: 20px;
        width: 95%;
      }
    }

    @media screen and (max-width: 767px) {
      .shipping-table-section h2 {
        font-size: 1.2rem;
        margin-bottom: 10px;
      }

      .shipping-table {
        font-size: 12px;
        display: block;
        width: 100%;
      }

      .shipping-table thead,
      .shipping-table tbody,
      .shipping-table th,
      .shipping-table td,
      .shipping-table tr {
        display: block;
      }

      .shipping-table thead {
        display: none;
      }

      .shipping-table tr {
        margin-bottom: 15px;
        border: 1px solid #FFD700;
        border-radius: 8px;
        padding: 10px;
        background-color: rgba(26, 26, 26, 0.5);
      }

      .shipping-table td {
        display: flex;
        flex-direction: column;
        padding: 8px 0;
        border: none;
        text-align: left;
      }

      .shipping-table td:before {
        content: attr(data-label);
        font-weight: bold;
        color: #FFD700;
        margin-bottom: 5px;
        font-size: 11px;
        text-transform: uppercase;
      }

      .shipping-table td:nth-child(4),
      .shipping-table td:nth-child(5),
      .shipping-table td:nth-child(6),
      .shipping-table td:nth-child(7) {
        display: inline-block;
        width: 24%;
        padding: 5px;
      }

      .shipping-table td:nth-child(4):before,
      .shipping-table td:nth-child(5):before,
      .shipping-table td:nth-child(6):before,
      .shipping-table td:nth-child(7):before {
        display: none;
      }

      .shipping-table button {
        width: 100%;
        font-size: 12px;
        padding: 10px 5px;
      }

      .shipping-table input[type="text"] {
        width: 100%;
        min-width: 100%;
        font-size: 16px;
      }

      .modal-content {
        padding: 15px;
        width: 95%;
        max-width: 95%;
      }

      .modal-content h3 {
        font-size: 1.2rem;
      }

      #messaggio-text {
        font-size: 14px;
      }

      .add-row-btn {
        width: 100%;
        padding: 12px;
        font-size: 14px;
      }
    }

    @media screen and (max-width: 480px) {
      .shipping-table-section {
        padding: 10px;
      }

      .modal-content {
        padding: 10px;
      }

      .close-modal {
        right: 10px;
        top: 5px;
        font-size: 24px;
      }

      #messaggio-text {
        font-size: 13px;
        padding: 8px;
      }
    }

    @media screen and (max-width: 767px) and (orientation: landscape) {
      .shipping-table thead {
        display: table-header-group;
      }

      .shipping-table tr {
        display: table-row;
        border: none;
        padding: 0;
      }

      .shipping-table td {
        display: table-cell;
        padding: 8px;
      }

      .shipping-table td:before {
        display: none;
      }
    }
  </style>
</head>
<body>

  <aside class="sb" id="sidebar">
    <div class="sb-header">
      <img src="./media/FHP_Group_Logo_RGB.png" alt="FHP Group" class="logo" />
      <a href="index.html" class="brand">Solespress</a>
    </div>

    <nav class="sb-nav">
      <a href="track.html" class="sb-btn active">
        <img src="./media/corrire.png" alt="Track" class="btn-icon-img" />
        <span class="btn-text">Track</span>
      </a>
    </nav>

    <div class="sb-footer">
      <small>v1.0 • Solespress</small>
    </div>
  </aside>

  <div class="overlay" id="overlay"></div>

  <main class="main track-page">
    <section id="griglia-spedizioni" class="shipping-table-section">
      <h2>Tabella Spedizioni</h2>
      <table class="shipping-table">
        <thead>
          <tr>
            <th>Mittente</th>
            <th>Destinatario</th>
            <th>N° Tracking / Link</th>
            <th>Apri</th>
            <th>Copia</th>
            <th>Invia</th>
            <th>Elimina</th>
          </tr>
        </thead>
        <tbody id="tabella-body">
          <tr>
            <td data-label="Mittente"><input type="text" placeholder="Nome mittente"></td>
            <td data-label="Destinatario"><input type="text" placeholder="Nome destinatario"></td>
            <td data-label="N° Tracking"><input type="text" placeholder="N° tracking o URL"></td>
            <td data-label="Apri"><button class="apri-link">Vai</button></td>
            <td data-label="Copia"><button class="copia-link">Copia</button></td>
            <td data-label="Invia"><button class="invia-messaggio">Invia</button></td>
            <td data-label="Elimina"><button class="elimina-riga">Elimina</button></td>
          </tr>
        </tbody>
      </table>
      <button id="aggiungi-riga" class="add-row-btn">+ Aggiungi riga</button>
    </section>

    <div id="messaggio-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Messaggio Tracking</h3>
        <textarea id="messaggio-text" readonly rows="8" style="width: 100%; padding: 10px; font-family: inherit; margin-bottom: 10px;"></textarea>
        <button id="copia-messaggio" class="add-row-btn">Copia Messaggio</button>
      </div>
    </div>
    <a href="#" id="mobileSidebarToggle" class="mobile-home-link">
      <img src="./media/solespress7272push.png" alt="Solespress" />
    </a>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('aggiungi-riga');
      const body = document.getElementById('tabella-body');

      if (btn) {
        btn.addEventListener('click', () => {
          const righe = body.querySelectorAll('tr');
          if (righe.length >= 10) {
            alert('Hai raggiunto il massimo di 10 righe');
            return;
          }

          if (righe.length > 0) {
            const ultimaRiga = righe[righe.length - 1];
            const inputs = ultimaRiga.querySelectorAll('input[type="text"]');
            const mittente = inputs[0] ? inputs[0].value.trim() : '';
            const destinatario = inputs[1] ? inputs[1].value.trim() : '';
            const tracking = inputs[2] ? inputs[2].value.trim() : '';

            if (!mittente || !destinatario || !tracking) {
              alert('Compila tutti i campi della riga precedente prima di aggiungerne una nuova');
              return;
            }
          }

          const nuovaRiga = document.createElement('tr');
          nuovaRiga.innerHTML = \`
            <td data-label="Mittente"><input type="text" placeholder="Nome mittente"></td>
            <td data-label="Destinatario"><input type="text" placeholder="Nome destinatario"></td>
            <td data-label="N° Tracking"><input type="text" placeholder="N° tracking o URL"></td>
            <td data-label="Apri"><button class="apri-link">Vai</button></td>
            <td data-label="Copia"><button class="copia-link">Copia</button></td>
            <td data-label="Invia"><button class="invia-messaggio">Invia</button></td>
            <td data-label="Elimina"><button class="elimina-riga">Elimina</button></td>
          \`;
          body.appendChild(nuovaRiga);
        });
      }

      function buildTrackingUrl(input) {
        if (!input) return null;
        input = input.trim();

        if (input.match(/^https?:\/\//i)) {
          return input;
        }

        if (/^1Z[A-Z0-9]+$/i.test(input)) {
          return \`https://www.ups.com/track?track=yes&trackNums=\${input}&loc=it_IT&requester=ST/trackdetails\`;
        }

        if (/^\d{10,11}$/.test(input)) {
          return \`https://www.dhl.com/it-en/home/tracking.html?tracking-id=\${input}&submit=1\`;
        }

        if (/^\d{13}$/.test(input)) {
          return \`https://www.poste.it/cerca/index.html#/risultati-spedizioni/\${input}\`;
        }

        if (/^\d{12}$/.test(input) || /^\d{14,}$/.test(input)) {
          return \`https://www.fedex.com/fedextrack/duplicate-results/select?duplicateTrackingId=\${input}&trknbr=\${input}\`;
        }

        if (input.includes('.') && !input.includes(' ')) {
          return \`https://\${input}\`;
        }

        if (/^\d+$/.test(input)) {
          return \`https://www.fedex.com/fedextrack/?trknbr=\${encodeURIComponent(input)}\`;
        }

        return null;
      }

      document.addEventListener('click', e => {
        if (e.target.classList.contains('apri-link')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const trackingInput = inputs[2];
          const input = trackingInput ? trackingInput.value : '';
          const trackingUrl = buildTrackingUrl(input);

          if (trackingUrl) {
            window.open(trackingUrl, '_blank');
          } else {
            alert('Inserisci un numero di tracking o un link valido');
          }
        }

        if (e.target.classList.contains('copia-link')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const trackingInput = inputs[2];
          const input = trackingInput ? trackingInput.value : '';
          const trackingUrl = buildTrackingUrl(input);

          if (trackingUrl) {
            navigator.clipboard.writeText(trackingUrl).then(() => {
              const btn = e.target;
              const originalText = btn.textContent;
              btn.textContent = '✓ Copiato!';
              btn.style.backgroundColor = '#28a745';

              setTimeout(() => {
                btn.textContent = originalText;
                btn.style.backgroundColor = '';
              }, 2000);
            }).catch(err => {
              alert('Errore durante la copia: ' + err);
            });
          } else {
            alert('Inserisci un numero di tracking o un link valido');
          }
        }

        if (e.target.classList.contains('invia-messaggio')) {
          const row = e.target.closest('tr');
          const inputs = row.querySelectorAll('input[type="text"]');
          const mittente = inputs[0] ? inputs[0].value.trim() : '';
          const destinatario = inputs[1] ? inputs[1].value.trim() : '';
          const trackingInput = inputs[2] ? inputs[2].value.trim() : '';

          if (!mittente || !destinatario || !trackingInput) {
            alert('Compila tutti i campi (Mittente, Destinatario e N° Tracking)');
            return;
          }

          const trackingUrl = buildTrackingUrl(trackingInput);
          if (!trackingUrl) {
            alert('Numero di tracking non valido');
            return;
          }

          const messaggio = \`Gentile \${destinatario},

La spedizione da parte di \${mittente} è stata inviata.

Codice di monitoraggio: \${trackingInput}

Puoi tracciare la tua spedizione al seguente link:
\${trackingUrl}

Cordiali saluti,
\${mittente}\`;

          const modal = document.getElementById('messaggio-modal');
          const textarea = document.getElementById('messaggio-text');
          textarea.value = messaggio;
          modal.style.display = 'flex';
        }

        if (e.target.classList.contains('elimina-riga')) {
          const righe = body.querySelectorAll('tr');

          if (righe.length <= 1) {
            alert('Devi mantenere almeno una riga nella tabella');
            return;
          }

          const row = e.target.closest('tr');
          row.remove();
        }
      });

      const modal = document.getElementById('messaggio-modal');
      const closeBtn = document.querySelector('.close-modal');

      closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
      });

      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
        }
      });

      document.getElementById('copia-messaggio').addEventListener('click', () => {
        const textarea = document.getElementById('messaggio-text');
        textarea.select();
        navigator.clipboard.writeText(textarea.value).then(() => {
          const btn = document.getElementById('copia-messaggio');
          const originalText = btn.textContent;
          btn.textContent = '✓ Messaggio Copiato!';
          btn.style.backgroundColor = '#28a745';

          setTimeout(() => {
            btn.textContent = originalText;
            btn.style.backgroundColor = '';
          }, 2000);
        }).catch(err => {
          alert('Errore durante la copia: ' + err);
        });
      });

      const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');

      if (mobileSidebarToggle) {
        mobileSidebarToggle.addEventListener('click', (e) => {
          e.preventDefault();
          document.body.classList.add('sidebar-open');
        });
      }

      if (overlay) {
        overlay.addEventListener('click', () => {
          document.body.classList.remove('sidebar-open');
        });
      }
    });
  </script>
</body>
</html>
